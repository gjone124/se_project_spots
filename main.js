!function(){"use strict";const e=(e,t,r)=>{const n=t.id+"-error";e.querySelector("#"+n).textContent="",t.classList.remove(r.inputErrorClass)},t=(e,t,n)=>{(e=>e.some((e=>!e.validity.valid)))(e)?r(t,n):(t.disabled=!1,t.classList.remove(n.inactiveButtonClass))},r=(e,t)=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)},n={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error"};function o(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Save",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Saving...";e.textContent=t?n:r}const a=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkResponse)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._checkResponse)}addCard(e){let{name:t,link:r}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:r})}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}changeLikeStatus(e,t){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:this._headers}).then(this._checkResponse)}editUserInfo(e){let{name:t,about:r}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:r})}).then(this._checkResponse)}editUserAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._checkResponse)}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"506cab27-cb57-4614-a4cb-84697f37c55f","Content-Type":"application/json"}}),s=document.querySelector(".profile__avatar-button"),c=document.querySelector(".profile__avatar-image"),i=document.querySelector(".profile__edit-button"),l=document.querySelector(".profile__add-button"),d=document.querySelector(".profile__name"),u=document.querySelector(".profile__description"),m=document.querySelectorAll(".modal"),_=document.querySelector("#avatar-modal"),h=_.querySelector(".modal__form"),f=(_.querySelector(".modal__submit-button"),_.querySelector("#profile-avatar-input")),v=document.querySelector("#edit-modal"),p=v.querySelector(".modal__form"),y=v.querySelector("#profile-name-input"),b=v.querySelector("#profile-description-input"),S=document.querySelector("#add-card-modal"),k=S.querySelector(".modal__form"),q=S.querySelector(".modal__submit-button"),E=(S.querySelector("#add-card-caption-input"),S.querySelector("#add-card-link-input"),document.querySelector("#delete-card-modal")),L=E.querySelector(".modal__form"),g=document.querySelector(".modal__submit-button_cancel"),C=document.querySelector("#preview-modal"),U=C.querySelector(".modal__caption"),A=C.querySelector(".modal__image"),x=document.querySelector("#card-template"),D=document.querySelector(".cards__list");let $,I;function R(e){e.classList.add("modal_is-opened"),document.addEventListener("keydown",P)}function T(e){e.classList.remove("modal_is-opened"),document.removeEventListener("keydown",P)}function P(e){if("Escape"===e.key){const e=document.querySelector(".modal_is-opened");e&&T(e)}}function B(e){const t=x.content.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__text"),n=t.querySelector(".card__image");r.textContent=e.name,n.src=e.link,n.alt=e.name;const o=t.querySelector(".card__like-button"),s=t.querySelector(".card__delete-button");return e.isLiked&&o.classList.add("card__like-button_liked"),o.addEventListener("click",(t=>function(e,t){const r=e.target.classList.contains("card__like-button_liked");a.changeLikeStatus(t,r).then((()=>{e.target.classList.toggle("card__like-button_liked")})).catch((e=>{console.error(e)}))}(t,e._id))),s.addEventListener("click",(()=>{!function(e,t){$=e,I=t,R(E)}(t,e._id)})),n.addEventListener("click",(()=>{!function(e){const{_id:t,link:r,name:n,isLiked:o}=e;A.setAttribute("src",r),A.setAttribute("alt",n+" image"),U.textContent=n,R(C)}(e)})),t}var w;s.addEventListener("click",(()=>{R(_)})),h.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter;o(t,!0),a.editUserAvatar(f.value).then((e=>{c.src=e.avatar,T(_)})).catch(console.error).finally((()=>o(t,!1)))})),i.addEventListener("click",(()=>{var t,r;y.value=d.textContent.trim(),b.value=u.textContent.trim(),t=v,r=n,[y,b].forEach((n=>{e(t,n,r)})),R(v)})),p.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter;o(t,!0),a.editUserInfo({name:y.value,about:b.value}).then((e=>{d.textContent=e.name,u.textContent=e.about,T(v)})).catch(console.error).finally((()=>o(t,!1)))})),l.addEventListener("click",(()=>{R(S)})),k.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter,{name:s,link:c}=e.target.elements;o(t,!0),a.addCard({name:s.value,link:c.value}).then((t=>{const o=B(t);D.prepend(o),T(S),e.target.reset(),r(q,n)})).catch((e=>console.error(e))).finally((()=>o(t,!1)))})),L.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter;o(t,!0,"Delete","Deleting..."),a.deleteCard(I).then((()=>{T(E),$.remove()})).catch(console.error).finally((()=>o(t,!1,"Delete","Deleting...")))})),g.addEventListener("click",(()=>T(E))),w=n,Array.from(document.querySelectorAll(w.formSelector)).forEach((n=>{((n,o)=>{const a=Array.from(n.querySelectorAll(o.inputSelector)),s=n.querySelector(o.submitButtonSelector);t(a,s,o),n.addEventListener("reset",(()=>{r(s,o)})),a.forEach((r=>{r.addEventListener("input",(function(){((t,r,n)=>{r.validity.valid?e(t,r,n):((e,t,r,n)=>{const o=t.id+"-error";e.querySelector("#"+o).textContent=r,t.classList.add(n.inputErrorClass)})(t,r,r.validationMessage,n)})(n,r,o),t(a,s,o)}))}))})(n,w)})),document.querySelectorAll(".modal__close-button").forEach((e=>{const t=e.closest(".modal");e.addEventListener("click",(()=>T(t)))})),m.forEach((e=>{e.addEventListener("click",(t=>{t.target===e&&T(e)}))})),a.getAppInfo().then((e=>{let[t,r]=e;t.forEach((e=>{const t=B(e);D.append(t)})),d.textContent=r.name,u.textContent=r.about,c.src=r.avatar})).catch(console.error)}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QU8sSUFNM0R2QixFQUFPNkQsU0FBU3RDLElBQ2RBLEVBQU1DLGlCQUFpQixTQUFVSSxJQUMzQkEsRUFBTWEsU0FBV2xCLEdBQ25CRyxFQUFXSCxFQUNiLEdBQ0EsSUE0TEpwRSxFQUNHUSxhQUNBTSxNQUFLWixJQUF1QixJQUFyQnNILEVBQU9DLEdBQVN2SCxFQUN0QnNILEVBQU1kLFNBQVNnQixJQUNiLE1BQU03QyxFQUFjRixFQUFlK0MsR0FDbkMxRCxFQUFVMkQsT0FBTzlDLEVBQVksSUFHL0JsQyxFQUFZeEUsWUFBY3NKLEVBQVN2RyxLQUNuQzBCLEVBQW1CekUsWUFBY3NKLEVBQVM1RixNQUMxQ1csRUFBbUIwQyxJQUFNdUMsRUFBUzFGLE1BQU0sSUFFekMwRCxNQUFNRSxRQUFRQyxNIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9zY3JpcHRzL3ZhbGlkYXRpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy91dGlscy9oZWxwZXJzLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy91dGlscy9BcGkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgc2hvd0lucHV0RXJyb3IgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlLCBjb25maWcpID0+IHtcclxuICBjb25zdCBlcnJvck1lc3NhZ2VJRCA9IGlucHV0RWxlbWVudC5pZCArIFwiLWVycm9yXCI7XHJcbiAgY29uc3QgZXJyb3JNZXNzYWdlRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjXCIgKyBlcnJvck1lc3NhZ2VJRCk7XHJcbiAgZXJyb3JNZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcclxuICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZChjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcclxufTtcclxuXHJcbmNvbnN0IGhpZGVJbnB1dEVycm9yID0gKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGVycm9yTWVzc2FnZUlEID0gaW5wdXRFbGVtZW50LmlkICsgXCItZXJyb3JcIjtcclxuICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcIiNcIiArIGVycm9yTWVzc2FnZUlEKTtcclxuICBlcnJvck1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcclxuICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcclxufTtcclxuXHJcbmNvbnN0IGNoZWNrSW5wdXRWYWxpZGl0eSA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpID0+IHtcclxuICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgc2hvd0lucHV0RXJyb3IoXHJcbiAgICAgIGZvcm1FbGVtZW50LFxyXG4gICAgICBpbnB1dEVsZW1lbnQsXHJcbiAgICAgIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSxcclxuICAgICAgY29uZmlnXHJcbiAgICApO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpO1xyXG4gIH1cclxufTtcclxuXHJcbmNvbnN0IGhhc0ludmFsaWRJbnB1dCA9IChpbnB1dExpc3QsIGNvbmZpZykgPT4ge1xyXG4gIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXQpID0+IHtcclxuICAgIHJldHVybiAhaW5wdXQudmFsaWRpdHkudmFsaWQ7XHJcbiAgfSk7XHJcbn07XHJcblxyXG5jb25zdCB0b2dnbGVCdXR0b25TdGF0ZSA9IChpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZykgPT4ge1xyXG4gIGlmIChoYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0LCBjb25maWcpKSB7XHJcbiAgICBkaXNhYmxlQnV0dG9uKGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgfVxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGRpc2FibGVCdXR0b24gPSAoYnV0dG9uRWxlbWVudCwgY29uZmlnKSA9PiB7XHJcbiAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCByZXNldFZhbGlkYXRpb24gPSAoZm9ybUVsZW1lbnQsIGlucHV0TGlzdCwgY29uZmlnKSA9PiB7XHJcbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXQsIGNvbmZpZyk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG5jb25zdCBzZXRFdmVudExpc3RlbmVycyA9IChmb3JtRWxlbWVudCwgY29uZmlnKSA9PiB7XHJcbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcclxuICAgIGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmlucHV0U2VsZWN0b3IpXHJcbiAgKTtcclxuICBjb25zdCBidXR0b25FbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcihjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG5cclxuICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XHJcblxyXG4gIGZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNldFwiLCAoKSA9PiB7XHJcbiAgICBkaXNhYmxlQnV0dG9uKGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XHJcbiAgfSk7XHJcblxyXG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKTtcclxuICAgICAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChjb25maWcpID0+IHtcclxuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKSk7XHJcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcclxuICAgIHNldEV2ZW50TGlzdGVuZXJzKGZvcm1FbGVtZW50LCBjb25maWcpO1xyXG4gIH0pO1xyXG59O1xyXG4iLCJleHBvcnQgY29uc3Qgc2V0dGluZ3MgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX3N1Ym1pdC1idXR0b25fZGlzYWJsZWRcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvclwiLFxyXG59O1xyXG4iLCJleHBvcnQgZnVuY3Rpb24gc2V0QnV0dG9uVGV4dChcclxuICBidXR0b24sXHJcbiAgaXNMb2FkaW5nLFxyXG4gIG5vdExvYWRpbmdUZXh0ID0gXCJTYXZlXCIsXHJcbiAgbG9hZGluZ1RleHQgPSBcIlNhdmluZy4uLlwiXHJcbikge1xyXG4gIGlmIChpc0xvYWRpbmcpIHtcclxuICAgIC8vIHNldCBsb2FkaW5nIHRleHRcclxuICAgIGJ1dHRvbi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xyXG4gIH0gZWxzZSB7XHJcbiAgICAvLyBzZXQgbm90IGxvYWRpbmcgdGV4dCAoZGVmYXVsdCB0ZXh0KVxyXG4gICAgYnV0dG9uLnRleHRDb250ZW50ID0gbm90TG9hZGluZ1RleHQ7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbmltcG9ydCB7XHJcbiAgZW5hYmxlVmFsaWRhdGlvbixcclxuICByZXNldFZhbGlkYXRpb24sXHJcbiAgZGlzYWJsZUJ1dHRvbixcclxufSBmcm9tIFwiLi4vc2NyaXB0cy92YWxpZGF0aW9uLmpzXCI7XHJcbmltcG9ydCB7IHNldHRpbmdzIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi91dGlscy9BcGkuanNcIjtcclxuaW1wb3J0IHsgc2V0QnV0dG9uVGV4dCB9IGZyb20gXCIuLi91dGlscy9oZWxwZXJzLmpzXCI7XHJcblxyXG4vLyAvL0luc3RhbnRpYXRpbmcgSW5pdGlhbCBDYXJkc1xyXG4vLyAvLyAoZm9yIHRoaXMgcHJvamVjdCwgd2UgYXJlIGZldGNoaW5nIHRoZSBpbml0aWFsIGNhcmRzIGZyb20gdGhlIEFQSSB3aGljaCBvbmx5IGhhcyAxIGluaXRpYWwgY2FyZFxyXG4vLyAvLyBzbyB3ZSBhcmUgbm90IHVzaW5nIHRoaXMgbWV0aG9kIHRvIGFjY2VzcyB0aGUgY2FyZHMgYW55bW9yZSlcclxuLy8gY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4vLyAgIHtcclxuLy8gICAgIG5hbWU6IFwiVmFsIFRob3JlbnNcIixcclxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8xLXBob3RvLWJ5LW1vcml0ei1mZWxkbWFubi1mcm9tLXBleGVscy5qcGdcIixcclxuLy8gICB9LFxyXG5cclxuLy8gICB7XHJcbi8vICAgICBuYW1lOiBcIlJlc3RhdXJhbnQgdGVycmFjZVwiLFxyXG4vLyAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzItcGhvdG8tYnktY2VpbGluZS1mcm9tLXBleGVscy5qcGdcIixcclxuLy8gICB9LFxyXG5cclxuLy8gICB7XHJcbi8vICAgICBuYW1lOiBcIkFuIG91dGRvb3IgY2FmZVwiLFxyXG4vLyAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzMtcGhvdG8tYnktdHViYW51ci1kb2dhbi1mcm9tLXBleGVscy5qcGdcIixcclxuLy8gICB9LFxyXG5cclxuLy8gICB7XHJcbi8vICAgICBuYW1lOiBcIkEgdmVyeSBsb25nIGJyaWRnZSwgb3ZlciB0aGUgZm9yZXN0IGFuZCB0aHJvdWdoIHRoZSB0cmVlc1wiLFxyXG4vLyAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzQtcGhvdG8tYnktbWF1cmljZS1sYXNjaGV0LWZyb20tcGV4ZWxzLmpwZ1wiLFxyXG4vLyAgIH0sXHJcblxyXG4vLyAgIHtcclxuLy8gICAgIG5hbWU6IFwiVHVubmVsIHdpdGggbW9ybmluZyBsaWdodFwiLFxyXG4vLyAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzUtcGhvdG8tYnktdmFuLWFuaC1uZ3V5ZW4tZnJvbS1wZXhlbHMuanBnXCIsXHJcbi8vICAgfSxcclxuXHJcbi8vICAge1xyXG4vLyAgICAgbmFtZTogXCJNb3VudGFpbiBob3VzZVwiLFxyXG4vLyAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzYtcGhvdG8tYnktbW9yaXR6LWZlbGRtYW5uLWZyb20tcGV4ZWxzLmpwZ1wiLFxyXG4vLyAgIH0sXHJcblxyXG4vLyAgIHtcclxuLy8gICAgIG5hbWU6IFwiR29sZGVuIEdhdGUgQnJpZGdlXCIsXHJcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNy1waG90by1ieS1ncmlmZmluLXdvb2xkcmlkZ2UtZnJvbS1wZXhlbHMuanBnXCIsXHJcbi8vICAgfSxcclxuLy8gXTtcclxuXHJcbi8vIEluc3RhbnRpYXRpbmcgQVBJXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcIjUwNmNhYjI3LWNiNTctNDYxNC1hNGNiLTg0Njk3ZjM3YzU1ZlwiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7XHJcblxyXG4vLyBQcm9maWxlIEVsZW1lbnRzXHJcbmNvbnN0IGF2YXRhck1vZGFsQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXItYnV0dG9uXCIpO1xyXG5jb25zdCBhdmF0YXJJbWFnZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhci1pbWFnZVwiKTtcclxuY29uc3QgZWRpdFByb2ZpbGVNb2RhbEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIik7XHJcbmNvbnN0IGFkZENhcmRNb2RhbEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcclxuY29uc3QgcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XHJcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIik7XHJcblxyXG4vLyBNb2RhbCBGb3JtIEVsZW1lbnRzXHJcbmNvbnN0IG1vZGFscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxcIik7XHJcblxyXG4vLyBBdmF0YXIgTW9kYWwgRm9ybSBFbGVtZW50c1xyXG5jb25zdCBhdmF0YXJNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLW1vZGFsXCIpO1xyXG5jb25zdCBhdmF0YXJGb3JtRWxlbWVudCA9IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbmNvbnN0IGF2YXRhck1vZGFsU3VibWl0QnV0dG9uID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcclxuICBcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiXHJcbik7XHJcbmNvbnN0IGF2YXRhck1vZGFsTGlua0lucHV0ID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWF2YXRhci1pbnB1dFwiKTtcclxuXHJcbi8vIEVkaXQgUHJvZmlsZSBNb2RhbCBGb3JtIEVsZW1lbnRzXHJcbmNvbnN0IGVkaXRQcm9maWxlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtbW9kYWxcIik7XHJcbmNvbnN0IGVkaXRQcm9maWxlRm9ybUVsZW1lbnQgPSBlZGl0UHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbmNvbnN0IGVkaXRQcm9maWxlTW9kYWxOYW1lSW5wdXQgPSBlZGl0UHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIjcHJvZmlsZS1uYW1lLWlucHV0XCJcclxuKTtcclxuY29uc3QgZWRpdFByb2ZpbGVNb2RhbERlc2NyaXB0aW9uSW5wdXQgPSBlZGl0UHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiXHJcbik7XHJcblxyXG4vLyBBZGQgQ2FyZCAoYWthIE5ldyBQb3N0KSBNb2RhbCBGb3JtIEVsZW1lbnRzXHJcbmNvbnN0IGFkZENhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbW9kYWxcIik7XHJcbmNvbnN0IGFkZENhcmRGb3JtRWxlbWVudCA9IGFkZENhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG5jb25zdCBhZGRDYXJkTW9kYWxTdWJtaXRCdXR0b24gPSBhZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcclxuICBcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiXHJcbik7XHJcbmNvbnN0IGFkZENhcmRNb2RhbENhcHRpb25JbnB1dCA9IGFkZENhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiI2FkZC1jYXJkLWNhcHRpb24taW5wdXRcIlxyXG4pO1xyXG5jb25zdCBhZGRDYXJkTW9kYWxMaW5rSW5wdXQgPSBhZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcclxuICBcIiNhZGQtY2FyZC1saW5rLWlucHV0XCJcclxuKTtcclxuXHJcbi8vIERlbGV0ZSBDYXJkIE1vZGFsIEZvcm0gRWxlbWVudHNcclxuY29uc3QgZGVsZXRlQ2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNkZWxldGUtY2FyZC1tb2RhbFwiKTtcclxuY29uc3QgZGVsZXRlQ2FyZEZvcm0gPSBkZWxldGVDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuY29uc3QgZGVsZXRlQ2FyZEZvcm1DYW5jZWxCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLm1vZGFsX19zdWJtaXQtYnV0dG9uX2NhbmNlbFwiXHJcbik7XHJcblxyXG4vLyBQcmV2aWV3IE1vZGFsIEZvcm0gRWxlbWVudHNcclxuY29uc3QgcHJldmlld01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcmV2aWV3LW1vZGFsXCIpO1xyXG5jb25zdCBwcmV2aWV3TW9kYWxDYXB0aW9uRWxlbWVudCA9XHJcbiAgcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NhcHRpb25cIik7XHJcbmNvbnN0IHByZXZpZXdNb2RhbEltYWdlRWxlbWVudCA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcclxuXHJcbi8vIENhcmQgUmVsYXRlZCBFbGVtZW50c1xyXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIik7XHJcbmNvbnN0IGNhcmRzTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XHJcbmxldCBzZWxlY3RlZENhcmQ7XHJcbmxldCBzZWxlY3RlZENhcmRJZDtcclxuXHJcbi8vIEZ1bmN0aW9uIEZvciBDbGlja2luZyBPbiBMaWtlIEJ1dHRvblxyXG5mdW5jdGlvbiBoYW5kbGVMaWtlKGV2ZW50LCBpZCkge1xyXG4gIGNvbnN0IGlzTGlrZWQgPSBldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiY2FyZF9fbGlrZS1idXR0b25fbGlrZWRcIik7XHJcbiAgYXBpXHJcbiAgICAuY2hhbmdlTGlrZVN0YXR1cyhpZCwgaXNMaWtlZClcclxuICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ1dHRvbl9saWtlZFwiKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgICB9KTtcclxufVxyXG5cclxuLy8gRnVuY3Rpb24gVG8gT3BlbiBNb2RhbFxyXG5mdW5jdGlvbiBvcGVuTW9kYWwobW9kYWwpIHtcclxuICBtb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfaXMtb3BlbmVkXCIpO1xyXG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGhhbmRsZUNsaWNraW5nRXNjYXBlS2V5KTtcclxufVxyXG5cclxuLy8gRnVuY3Rpb24gVG8gQ2xvc2UgTW9kYWxcclxuZnVuY3Rpb24gY2xvc2VNb2RhbChtb2RhbCkge1xyXG4gIG1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9pcy1vcGVuZWRcIik7XHJcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlQ2xpY2tpbmdFc2NhcGVLZXkpO1xyXG59XHJcblxyXG4vLyBGdW5jdGlvbiBUbyBDbG9zZSBNb2RhbCBCeSBDbGlja2luZyBPbiBDbG9zZSBCdXR0b24gKFwiWFwiIEljb24pIFdpdGhpbiBQb3AgVXAgRm9ybVxyXG5mdW5jdGlvbiBoYW5kbGVDbGlja2luZ0Nsb3NlQnV0dG9uKCkge1xyXG4gIGNvbnN0IGNsb3NlQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiKTtcclxuICBjbG9zZUJ1dHRvbnMuZm9yRWFjaCgoYnV0dG9uKSA9PiB7XHJcbiAgICBjb25zdCBtb2RhbCA9IGJ1dHRvbi5jbG9zZXN0KFwiLm1vZGFsXCIpO1xyXG4gICAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBjbG9zZU1vZGFsKG1vZGFsKSk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8vIEZ1bmN0aW9uIFRvIENsb3NlIE1vZGFsIEJ5IENsaWNraW5nIE92ZXJsYXlcclxuZnVuY3Rpb24gaGFuZGxlQ2xpY2tpbmdPdmVybGF5KCkge1xyXG4gIG1vZGFscy5mb3JFYWNoKChtb2RhbCkgPT4ge1xyXG4gICAgbW9kYWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldmVudCkgPT4ge1xyXG4gICAgICBpZiAoZXZlbnQudGFyZ2V0ID09PSBtb2RhbCkge1xyXG4gICAgICAgIGNsb3NlTW9kYWwobW9kYWwpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9KTtcclxufVxyXG5cclxuLy8gRnVuY3Rpb24gVG8gQ2xvc2UgTW9kYWwgQnkgUHJlc3NpbmcgRXNjYXBlIEtleSAoXCJFc2NcIilcclxuZnVuY3Rpb24gaGFuZGxlQ2xpY2tpbmdFc2NhcGVLZXkoZXZlbnQpIHtcclxuICBpZiAoZXZlbnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICBjb25zdCBvcGVuTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX2lzLW9wZW5lZFwiKTtcclxuICAgIGlmIChvcGVuTW9kYWwpIHtcclxuICAgICAgY2xvc2VNb2RhbChvcGVuTW9kYWwpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuLy8gRnVuY3Rpb24gRm9yIENsaWNraW5nIE9uIERlbGV0ZSBCdXR0b24gKFRyYXNoIEljb24pXHJcbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNhcmQoY2FyZEVsZW1lbnQsIGNhcmRJZCkge1xyXG4gIHNlbGVjdGVkQ2FyZCA9IGNhcmRFbGVtZW50O1xyXG4gIHNlbGVjdGVkQ2FyZElkID0gY2FyZElkO1xyXG4gIG9wZW5Nb2RhbChkZWxldGVDYXJkTW9kYWwpO1xyXG59XHJcblxyXG4vLyBGdW5jdGlvbiBGb3IgQ2xpY2tpbmcgT24gQ29uZmlybWF0aW9uIERlbGV0ZSBCdXR0b25cclxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ2FyZFN1Ym1pdChldmVudCkge1xyXG4gIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gIC8vIGNoYW5nZXMgdGV4dCBjb250ZW50IHRvIFwiRGVsZXRpbmcuLi5cIiAoc2V0QnV0dG9uVGV4dCBpcyBtZXRob2QgZnJvbSBoZWxwZXJzLmpzKVxyXG4gIGNvbnN0IGRlbGV0ZUJ1dHRvbiA9IGV2ZW50LnN1Ym1pdHRlcjtcclxuICBzZXRCdXR0b25UZXh0KGRlbGV0ZUJ1dHRvbiwgdHJ1ZSwgXCJEZWxldGVcIiwgXCJEZWxldGluZy4uLlwiKTtcclxuICBhcGlcclxuICAgIC5kZWxldGVDYXJkKHNlbGVjdGVkQ2FyZElkKVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICBjbG9zZU1vZGFsKGRlbGV0ZUNhcmRNb2RhbCk7XHJcbiAgICAgIHNlbGVjdGVkQ2FyZC5yZW1vdmUoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcclxuXHJcbiAgICAvLyBjaGFuZ2VzIHRleHQgY29udGVudCBiYWNrIHRvIFwiRGVsZXRlXCJcclxuICAgIC5maW5hbGx5KCgpID0+IHNldEJ1dHRvblRleHQoZGVsZXRlQnV0dG9uLCBmYWxzZSwgXCJEZWxldGVcIiwgXCJEZWxldGluZy4uLlwiKSk7XHJcbn1cclxuXHJcbi8vIEZ1bmN0aW9uIEZvciBDbGlja2luZyBPbiBDYXJkIEltYWdlXHJcbmZ1bmN0aW9uIGhhbmRsZUNhcmRJbWFnZUNsaWNrKGRhdGEpIHtcclxuICBjb25zdCB7IF9pZDogaWQsIGxpbmssIG5hbWUsIGlzTGlrZWQgfSA9IGRhdGE7XHJcbiAgcHJldmlld01vZGFsSW1hZ2VFbGVtZW50LnNldEF0dHJpYnV0ZShcInNyY1wiLCBsaW5rKTtcclxuICBwcmV2aWV3TW9kYWxJbWFnZUVsZW1lbnQuc2V0QXR0cmlidXRlKFwiYWx0XCIsIG5hbWUgKyBcIiBpbWFnZVwiKTtcclxuICBwcmV2aWV3TW9kYWxDYXB0aW9uRWxlbWVudC50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgb3Blbk1vZGFsKHByZXZpZXdNb2RhbCk7XHJcbn1cclxuXHJcbi8vIEZ1bmN0aW9uIFRvIEhhbmRsZSBQcmVzc2luZyBTdWJtaXQgQnV0dG9uIEZvciBBdmF0YXIgTW9kYWxcclxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdChldmVudCkge1xyXG4gIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgY29uc3Qgc2F2ZUJ1dHRvbiA9IGV2ZW50LnN1Ym1pdHRlcjtcclxuICBzZXRCdXR0b25UZXh0KHNhdmVCdXR0b24sIHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLmVkaXRVc2VyQXZhdGFyKGF2YXRhck1vZGFsTGlua0lucHV0LnZhbHVlKVxyXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgYXZhdGFySW1hZ2VFbGVtZW50LnNyYyA9IGRhdGEuYXZhdGFyO1xyXG4gICAgICBjbG9zZU1vZGFsKGF2YXRhck1vZGFsKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcclxuICAgIC5maW5hbGx5KCgpID0+IHNldEJ1dHRvblRleHQoc2F2ZUJ1dHRvbiwgZmFsc2UpKTtcclxufVxyXG5cclxuLy8gRnVuY3Rpb24gVG8gSGFuZGxlIFByZXNzaW5nIFN1Ym1pdCBCdXR0b24gRm9yIEVkaXQgUHJvZmlsZSBNb2RhbFxyXG5mdW5jdGlvbiBoYW5kbGVFZGl0UHJvZmlsZUZvcm1TdWJtaXQoZXZlbnQpIHtcclxuICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAvLyBjaGFuZ2VzIHRleHQgY29udGVudCB0byBcIlNhdmluZy4uLlwiIChzZXRCdXR0b25UZXh0IGlzIG1ldGhvZCBmcm9tIGhlbHBlcnMuanMpXHJcbiAgY29uc3Qgc2F2ZUJ1dHRvbiA9IGV2ZW50LnN1Ym1pdHRlcjtcclxuICBzZXRCdXR0b25UZXh0KHNhdmVCdXR0b24sIHRydWUpO1xyXG5cclxuICBhcGlcclxuICAgIC5lZGl0VXNlckluZm8oe1xyXG4gICAgICBuYW1lOiBlZGl0UHJvZmlsZU1vZGFsTmFtZUlucHV0LnZhbHVlLFxyXG4gICAgICBhYm91dDogZWRpdFByb2ZpbGVNb2RhbERlc2NyaXB0aW9uSW5wdXQudmFsdWUsXHJcbiAgICB9KVxyXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgLy8gdXNlIGRhdGEgYXJndW1lbnRzIGluc3RlYWQgb2YgaW5wdXQgdmFsdWVzXHJcbiAgICAgIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gICAgICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBkYXRhLmFib3V0O1xyXG4gICAgICBjbG9zZU1vZGFsKGVkaXRQcm9maWxlTW9kYWwpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxyXG4gICAgLmZpbmFsbHkoKCkgPT5cclxuICAgICAgLy8gY2hhbmdlcyB0ZXh0IGNvbnRlbnQgYmFjayB0byBcIlNhdmVcIlxyXG4gICAgICBzZXRCdXR0b25UZXh0KHNhdmVCdXR0b24sIGZhbHNlKVxyXG4gICAgKTtcclxufVxyXG5cclxuLy8gRnVuY3Rpb24gVG8gSGFuZGxlIFByZXNzaW5nIFN1Ym1pdCBCdXR0b24gRm9yIEFkZCBDYXJkIChOZXcgUG9zdCkgTW9kYWxcclxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZEZvcm1TdWJtaXQoZXZlbnQpIHtcclxuICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGNvbnN0IHNhdmVCdXR0b24gPSBldmVudC5zdWJtaXR0ZXI7XHJcbiAgY29uc3QgeyBuYW1lLCBsaW5rIH0gPSBldmVudC50YXJnZXQuZWxlbWVudHM7XHJcblxyXG4gIHNldEJ1dHRvblRleHQoc2F2ZUJ1dHRvbiwgdHJ1ZSk7XHJcbiAgYXBpXHJcbiAgICAuYWRkQ2FyZCh7XHJcbiAgICAgIG5hbWU6IG5hbWUudmFsdWUsXHJcbiAgICAgIGxpbms6IGxpbmsudmFsdWUsXHJcbiAgICB9KVxyXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgY29uc3QgYWRkQ2FyZEVsZW1lbnQgPSBnZXRDYXJkRWxlbWVudChkYXRhKTtcclxuICAgICAgY2FyZHNMaXN0LnByZXBlbmQoYWRkQ2FyZEVsZW1lbnQpO1xyXG4gICAgICBjbG9zZU1vZGFsKGFkZENhcmRNb2RhbCk7XHJcbiAgICAgIGV2ZW50LnRhcmdldC5yZXNldCgpO1xyXG4gICAgICBkaXNhYmxlQnV0dG9uKGFkZENhcmRNb2RhbFN1Ym1pdEJ1dHRvbiwgc2V0dGluZ3MpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKGVycikpXHJcbiAgICAuZmluYWxseSgoKSA9PiBzZXRCdXR0b25UZXh0KHNhdmVCdXR0b24sIGZhbHNlKSk7XHJcbn1cclxuXHJcbi8vIEF2YXRhciBNb2RhbCBFdmVudCBMaXN0ZW5lcnNcclxuYXZhdGFyTW9kYWxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBvcGVuTW9kYWwoYXZhdGFyTW9kYWwpO1xyXG59KTtcclxuYXZhdGFyRm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVBdmF0YXJGb3JtU3VibWl0KTtcclxuXHJcbi8vIEVkaXQgUHJvZmlsZSBNb2RhbCBFdmVudCBMaXN0ZW5lcnNcclxuZWRpdFByb2ZpbGVNb2RhbEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGVkaXRQcm9maWxlTW9kYWxOYW1lSW5wdXQudmFsdWUgPSBwcm9maWxlTmFtZS50ZXh0Q29udGVudC50cmltKCk7XHJcbiAgZWRpdFByb2ZpbGVNb2RhbERlc2NyaXB0aW9uSW5wdXQudmFsdWUgPVxyXG4gICAgcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50LnRyaW0oKTtcclxuICByZXNldFZhbGlkYXRpb24oXHJcbiAgICBlZGl0UHJvZmlsZU1vZGFsLFxyXG4gICAgW2VkaXRQcm9maWxlTW9kYWxOYW1lSW5wdXQsIGVkaXRQcm9maWxlTW9kYWxEZXNjcmlwdGlvbklucHV0XSxcclxuICAgIHNldHRpbmdzXHJcbiAgKTtcclxuICBvcGVuTW9kYWwoZWRpdFByb2ZpbGVNb2RhbCk7XHJcbn0pO1xyXG5cclxuZWRpdFByb2ZpbGVGb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUVkaXRQcm9maWxlRm9ybVN1Ym1pdCk7XHJcblxyXG4vLyBBZGQgQ2FyZCBNb2RhbCBFdmVudCBMaXN0ZW5lcnNcclxuYWRkQ2FyZE1vZGFsQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgb3Blbk1vZGFsKGFkZENhcmRNb2RhbCk7XHJcbn0pO1xyXG5cclxuYWRkQ2FyZEZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlQWRkQ2FyZEZvcm1TdWJtaXQpO1xyXG5cclxuLy8gRGVsZXRlIENhcmQgTW9kYWwgRXZlbnQgTGlzdGVuZXJzIChDb25maXJtYXRpb24gRGVsZXRlIEJ1dHRvbiAmIENhbmNlbCBCdXR0b24pXHJcbmRlbGV0ZUNhcmRGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlRGVsZXRlQ2FyZFN1Ym1pdCk7XHJcbmRlbGV0ZUNhcmRGb3JtQ2FuY2VsQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxyXG4gIGNsb3NlTW9kYWwoZGVsZXRlQ2FyZE1vZGFsKVxyXG4pO1xyXG5cclxuLy8gRnVuY3Rpb24gVG8gQ3JlYXRlIEEgQ2FyZFxyXG5mdW5jdGlvbiBnZXRDYXJkRWxlbWVudChkYXRhKSB7XHJcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkVGVtcGxhdGUuY29udGVudFxyXG4gICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxyXG4gICAgLmNsb25lTm9kZSh0cnVlKTtcclxuXHJcbiAgY29uc3QgY2FyZENhcHRpb25FbGVtZW50ID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190ZXh0XCIpO1xyXG4gIGNvbnN0IGNhcmRJbWFnZUVsZW1lbnQgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG5cclxuICBjYXJkQ2FwdGlvbkVsZW1lbnQudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgY2FyZEltYWdlRWxlbWVudC5zcmMgPSBkYXRhLmxpbms7XHJcbiAgY2FyZEltYWdlRWxlbWVudC5hbHQgPSBkYXRhLm5hbWU7XHJcblxyXG4gIGNvbnN0IGNhcmRMaWtlQnV0dG9uID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcclxuICBjb25zdCBjYXJkRGVsZXRlQnV0dG9uID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpO1xyXG5cclxuICAvLyBJZiBDYXJkIElzIExpa2VkLCBTZXQgQWN0aXZlIENsYXNzIE9uIENhcmRcclxuICBpZiAoZGF0YS5pc0xpa2VkKSB7XHJcbiAgICBjYXJkTGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fbGlrZWRcIik7XHJcbiAgfVxyXG5cclxuICAvLyBMaWtlIEJ1dHRvbiBFdmVudCBMaXN0ZW5lclxyXG4gIGNhcmRMaWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+XHJcbiAgICBoYW5kbGVMaWtlKGV2ZW50LCBkYXRhLl9pZClcclxuICApO1xyXG5cclxuICAvLyBEZWxldGUgQnV0dG9uIChUcmFzaCBJY29uKSBFdmVudCBMaXN0ZW5lclxyXG4gIGNhcmREZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIGhhbmRsZURlbGV0ZUNhcmQoY2FyZEVsZW1lbnQsIGRhdGEuX2lkKTtcclxuICB9KTtcclxuXHJcbiAgLy8gQ2FyZCBJbWFnZSBFdmVudCBMaXN0ZW5lclxyXG4gIGNhcmRJbWFnZUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIGhhbmRsZUNhcmRJbWFnZUNsaWNrKGRhdGEpO1xyXG4gIH0pO1xyXG5cclxuICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbn1cclxuXHJcbi8vIEZ1bmN0aW9uIFRvIERpc3BsYXkgQWxsIE9mIFRoZSBDYXJkcyBGcm9tIEFQSSBEYXRhYmFzZVxyXG5mdW5jdGlvbiBnZXRJbml0aWFsRGF0YSgpIHtcclxuICBhcGlcclxuICAgIC5nZXRBcHBJbmZvKClcclxuICAgIC50aGVuKChbY2FyZHMsIHVzZXJJbmZvXSkgPT4ge1xyXG4gICAgICBjYXJkcy5mb3JFYWNoKChjYXJkRGF0YSkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZ2V0Q2FyZEVsZW1lbnQoY2FyZERhdGEpO1xyXG4gICAgICAgIGNhcmRzTGlzdC5hcHBlbmQoY2FyZEVsZW1lbnQpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gdXNlckluZm8ubmFtZTtcclxuICAgICAgcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gdXNlckluZm8uYWJvdXQ7XHJcbiAgICAgIGF2YXRhckltYWdlRWxlbWVudC5zcmMgPSB1c2VySW5mby5hdmF0YXI7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xyXG59XHJcblxyXG5lbmFibGVWYWxpZGF0aW9uKHNldHRpbmdzKTtcclxuaGFuZGxlQ2xpY2tpbmdDbG9zZUJ1dHRvbigpO1xyXG5oYW5kbGVDbGlja2luZ092ZXJsYXkoKTtcclxuZ2V0SW5pdGlhbERhdGEoKTtcclxuIiwiY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcclxuICB9XHJcblxyXG4gIGdldEFwcEluZm8oKSB7XHJcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZ2V0SW5pdGlhbENhcmRzKCksIHRoaXMuZ2V0VXNlckluZm8oKV0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGFkZENhcmQoeyBuYW1lLCBsaW5rIH0pIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgbGluayxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChpZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgY2hhbmdlTGlrZVN0YXR1cyhpZCwgaXNMaWtlZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IGlzTGlrZWQgPyBcIkRFTEVURVwiIDogXCJQVVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBlZGl0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZSxcclxuICAgICAgICBhYm91dCxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZWRpdFVzZXJBdmF0YXIoYXZhdGFyKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIGF2YXRhcixcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gIH1cclxufVxyXG5cclxuLy8gZXhwb3J0IHRoZSBjbGFzc1xyXG5leHBvcnQgZGVmYXVsdCBBcGk7XHJcbiJdLCJuYW1lcyI6WyJoaWRlSW5wdXRFcnJvciIsImZvcm1FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiY29uZmlnIiwiZXJyb3JNZXNzYWdlSUQiLCJpZCIsInF1ZXJ5U2VsZWN0b3IiLCJ0ZXh0Q29udGVudCIsImNsYXNzTGlzdCIsInJlbW92ZSIsImlucHV0RXJyb3JDbGFzcyIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiaW5wdXRMaXN0IiwiYnV0dG9uRWxlbWVudCIsImhhc0ludmFsaWRJbnB1dCIsInNvbWUiLCJpbnB1dCIsInZhbGlkaXR5IiwidmFsaWQiLCJkaXNhYmxlQnV0dG9uIiwiZGlzYWJsZWQiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiYWRkIiwic2V0dGluZ3MiLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJlcnJvckNsYXNzIiwic2V0QnV0dG9uVGV4dCIsImJ1dHRvbiIsImlzTG9hZGluZyIsIm5vdExvYWRpbmdUZXh0IiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwibG9hZGluZ1RleHQiLCJhcGkiLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJiYXNlVXJsIiwiaGVhZGVycyIsInRoaXMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiZ2V0QXBwSW5mbyIsIlByb21pc2UiLCJhbGwiLCJnZXRJbml0aWFsQ2FyZHMiLCJnZXRVc2VySW5mbyIsImZldGNoIiwidGhlbiIsIl9jaGVja1Jlc3BvbnNlIiwiYWRkQ2FyZCIsIl9yZWYyIiwibmFtZSIsImxpbmsiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImRlbGV0ZUNhcmQiLCJjaGFuZ2VMaWtlU3RhdHVzIiwiaXNMaWtlZCIsImVkaXRVc2VySW5mbyIsIl9yZWYzIiwiYWJvdXQiLCJlZGl0VXNlckF2YXRhciIsImF2YXRhciIsInJlcyIsIm9rIiwianNvbiIsInJlamVjdCIsInN0YXR1cyIsImF1dGhvcml6YXRpb24iLCJhdmF0YXJNb2RhbEJ1dHRvbiIsImRvY3VtZW50IiwiYXZhdGFySW1hZ2VFbGVtZW50IiwiZWRpdFByb2ZpbGVNb2RhbEJ1dHRvbiIsImFkZENhcmRNb2RhbEJ1dHRvbiIsInByb2ZpbGVOYW1lIiwicHJvZmlsZURlc2NyaXB0aW9uIiwibW9kYWxzIiwicXVlcnlTZWxlY3RvckFsbCIsImF2YXRhck1vZGFsIiwiYXZhdGFyRm9ybUVsZW1lbnQiLCJhdmF0YXJNb2RhbExpbmtJbnB1dCIsImVkaXRQcm9maWxlTW9kYWwiLCJlZGl0UHJvZmlsZUZvcm1FbGVtZW50IiwiZWRpdFByb2ZpbGVNb2RhbE5hbWVJbnB1dCIsImVkaXRQcm9maWxlTW9kYWxEZXNjcmlwdGlvbklucHV0IiwiYWRkQ2FyZE1vZGFsIiwiYWRkQ2FyZEZvcm1FbGVtZW50IiwiYWRkQ2FyZE1vZGFsU3VibWl0QnV0dG9uIiwiZGVsZXRlQ2FyZE1vZGFsIiwiZGVsZXRlQ2FyZEZvcm0iLCJkZWxldGVDYXJkRm9ybUNhbmNlbEJ1dHRvbiIsInByZXZpZXdNb2RhbCIsInByZXZpZXdNb2RhbENhcHRpb25FbGVtZW50IiwicHJldmlld01vZGFsSW1hZ2VFbGVtZW50IiwiY2FyZFRlbXBsYXRlIiwiY2FyZHNMaXN0Iiwic2VsZWN0ZWRDYXJkIiwic2VsZWN0ZWRDYXJkSWQiLCJvcGVuTW9kYWwiLCJtb2RhbCIsImFkZEV2ZW50TGlzdGVuZXIiLCJoYW5kbGVDbGlja2luZ0VzY2FwZUtleSIsImNsb3NlTW9kYWwiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJrZXkiLCJnZXRDYXJkRWxlbWVudCIsImRhdGEiLCJjYXJkRWxlbWVudCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJjYXJkQ2FwdGlvbkVsZW1lbnQiLCJjYXJkSW1hZ2VFbGVtZW50Iiwic3JjIiwiYWx0IiwiY2FyZExpa2VCdXR0b24iLCJjYXJkRGVsZXRlQnV0dG9uIiwidGFyZ2V0IiwiY29udGFpbnMiLCJ0b2dnbGUiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsImhhbmRsZUxpa2UiLCJfaWQiLCJjYXJkSWQiLCJoYW5kbGVEZWxldGVDYXJkIiwic2V0QXR0cmlidXRlIiwiaGFuZGxlQ2FyZEltYWdlQ2xpY2siLCJwcmV2ZW50RGVmYXVsdCIsInNhdmVCdXR0b24iLCJzdWJtaXR0ZXIiLCJ2YWx1ZSIsImZpbmFsbHkiLCJyZXNldFZhbGlkYXRpb24iLCJ0cmltIiwiZm9yRWFjaCIsImVsZW1lbnRzIiwiYWRkQ2FyZEVsZW1lbnQiLCJwcmVwZW5kIiwicmVzZXQiLCJkZWxldGVCdXR0b24iLCJBcnJheSIsImZyb20iLCJzZXRFdmVudExpc3RlbmVycyIsImNoZWNrSW5wdXRWYWxpZGl0eSIsInNob3dJbnB1dEVycm9yIiwiZXJyb3JNZXNzYWdlIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJjbG9zZXN0IiwiY2FyZHMiLCJ1c2VySW5mbyIsImNhcmREYXRhIiwiYXBwZW5kIl0sInNvdXJjZVJvb3QiOiIifQ==